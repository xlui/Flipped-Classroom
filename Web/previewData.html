<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>预习资料</title>
    <link rel="stylesheet" href="css/base.css">
    <script src="js/jquery-3.2.1.min.js"></script>
</head>
<body>
<div class="pageContentArea" id="pageHeight">
    <header>
        <h1><a href="index.html">翻转课堂</a></h1>
        <ul id="addOnMouseOver">
            <li class="logAndReg"><a href="javascript:void(0)"><span>个人信息</span></a></li>
        </ul>
    </header>
    <section>
        <aside>
            <nav class="menuNav">
                <ul>
                    <li><a href=""><span>基本信息</span></a></li>
                    <li style="background-color: #CFFCF3"><a href=""><span
                            style="color: chocolate">预习资料</span></a></li>
                    <li><a href=""><span>电子资料</span></a></li>
                    <li><a href=""><span>课程留言</span></a></li>
                </ul>
            </nav>
        </aside>
        <section id="baseInfoSection">
            <div class="navName">
                <h3>管理预习资料</h3>
            </div>
            <div class="courseInfo">
                <form action="">

                </form>
            </div>
            <div class="navName">
                <h3>上传预习资料</h3>
            </div>
            <div class="upLoadFile">
                <form id="fileForm" action="javascript: submit();">
                    <input type="file" name="file" id="file" required/>
                    <div style="background:#848484;width:100px;display: inline-block">
                        <div id="progressNumber" style="background:#428bca;width:0;height:10px">
                        </div>
                    </div>
                    <span id="percent">0%</span>
                    <input type="submit" value="提交"/>
                </form>
            </div>
        </section>
    </section>
    <footer>

    </footer>
</div>

<script src="js/data.js"></script>
<script src="js/myLib.js"></script>
<script>
    setSizeLayout();
    landscapingInterface();
    RenderDomInfo();
    addMenuNavUrl();

    function submit() {
        var fd = new FormData();
        var file = $("#file")[0].files[0];
        fd.append("file", file);
        var baseUrl = "https://api.fc.xd.style";
        $.ajax({
            type: 'POST',
            url: baseUrl + "/course/" + currentID + "/data/preview",
            data: fd,
            cache: false,
            processData: false,
            contentType: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader("authorization", getCookie("userToken"))
            },
            xhr: function () {
                var xhr = $.ajaxSettings.xhr();
                if (xhr.upload) {
                    xhr.upload.addEventListener("progress", handleProgress, false);
                    return xhr;
                }
            }
        }).done(function (res) {
            alert("Done: " + res);
        }).fail(function (res) {
            alert("Fail: " + res);
        });
    }

    function handleProgress(e) {
        var percentComplete = Math.round((e.loaded) * 100 / e.total);
        $("#percent").html(percentComplete + '%');
        $("#progressNumber").css("width", "" + percentComplete + "px");
    }

        function deletePreData(ele) {
        var previewId = $(ele).attr("data-message-id");
            alert(typeof previewId);
        var baseUrl = "https://api.fc.xd.style/course/1/data/preview/"+previewId;
        alert(baseUrl);
        $.ajax({
            type: "DELETE",
            url: baseUrl,
            headers: {
                Authorization: getCookie("userToken")
            },
            success: function (result) {
                console.log(1);
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            },

        });

    }
</script>
</body>
</html>